(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,a){},119:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(12),c=a.n(o),l=a(36),u=(a(68),a(24)),i=a(25),s=a(28),m=a(26),d=a(29),g=a(13),p=a(15),h=a(4),f=a(62),b=a(37),v=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).raiseSort=function(e){var t=Object(f.a)({},a.props.sortColumn);t.path===e?t.order="asc"===t.order?"desc":"asc":(t.path=e,t.order="asc"),a.props.onSort(t)},a.renderSortIcon=function(e){var t=a.props.sortColumn;return e.path!==t.path?null:"asc"===t.order?r.a.createElement(b.a,{icon:["fas","caret-up"]}):r.a.createElement(b.a,{icon:["fas","caret-down"]})},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("thead",null,r.a.createElement("tr",null,this.props.columns.map(function(t){return r.a.createElement("th",{className:"clickable",key:t.path||t.key,onClick:function(){return e.raiseSort(t.path)}},t.label," ",e.renderSortIcon(t))})))}}]),t}(n.Component),E=a(5),y=a.n(E);function j(e,t){return"".concat(e.id,"_").concat(t.path||t.key)}var O=function(e){var t=e.data,a=e.columns;return r.a.createElement("tbody",null,function(e,t){return e.map(function(e){return r.a.createElement("tr",{key:e.id},t.map(function(t){return r.a.createElement("td",{key:j(e,t),id:j(e,t)},function(e,t){return t.content?t.content(e):y.a.get(e,t.path)}(e,t))}))})}(t,a))},S=function(e){var t=e.columns,a=e.sortColumn,n=e.onSort,o=e.data;return r.a.createElement("table",{className:"table"},r.a.createElement(v,{columns:t,sortColumn:a,onSort:n}),r.a.createElement(O,{columns:t,data:o}))},C=function(e){var t=e.earthquakedata,a=e.onSort,n=e.sortColumn;return r.a.createElement(S,{columns:[{path:"place",label:"Location",content:function(e){return r.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},e.place)}},{path:"timeFormatted",label:"Event Time"},{path:"mag",label:"Magitude"},{path:"magType",label:"MagType"}],data:t,sortColumn:n,onSort:a})};var k=function(e){var t=e.itemsCount,a=e.pageSize,n=e.currentPage,o=e.onPageChange,c=Math.ceil(t/a);if(1===c)return null;var l=y.a.range(1,c+1);return r.a.createElement("nav",null,r.a.createElement("ul",{className:"pagination"},l.map(function(e){return r.a.createElement("li",{key:e,className:e===n?"page-item active":"page-item"},r.a.createElement("a",{onClick:function(){return o(e)},className:"page-link",href:"##"},e))})))},M=a(38),D=a.n(M),T=a(53),w=a(30),N=a.n(w);N.a.defaults.baseURL="https://earthquake.usgs.gov/fdsnws/event/1",N.a.interceptors.response.use(null,function(e){return e.response&&e.response.status>=400&&e.response.status<500||p.b.error("An unexpected error occured"),Promise.reject(e)});var q={get:N.a.get},L="/query",F="geojson";function Y(e){return q.get(function(e){return"".concat(L,"?format=").concat(F,"&").concat(e)}(e))}var x=a(27),P=a.n(x),z=function(e){var t=[],a=[],n=e.map(function(e){var n=y.a.pick(e.properties,["place","time","url","mag","magType"]);return n.id=e.id,n.timeFormatted=P()({date:new Date(n.time),local:!0,showTimeZone:!0}),n.geoType=e.geometry.type,n.geo=e.geometry.coordinates,n.magSelectionHook=Math.trunc(n.mag),t.push(n.magSelectionHook),a.push(n.magType),n});return t=y.a.sortBy(t),t=y.a.sortedUniqBy(t,Math.floor),a=y.a.sortBy(a),a=y.a.sortedUniqBy(a),a=y.a.compact(a),{extractedEarthquakeData:n,magList:t,magTypeList:a}};var B=function(e){var t=e.currentpage,a=e.earthquakedata,n=e.selectedMagitude,r=e.selectedMagitudeType,o=e.searchQuery,c=e.sortcolumn,l=a;console.log({searchQuery:o,selectedMagitude:n,selectedMagitudeType:r}),o&&o.length>=1?l=a.filter(function(e){return e.place.toLowerCase().includes(o.toLocaleLowerCase())}):""!==n?l=a.filter(function(e){return e.magSelectionHook===n}):""!==r&&(l=a.filter(function(e){return e.magType===r}));var u=y.a.orderBy(l,[c.path],[c.order]),i=l?l.length:0,s=function(e){for(var t=0,a=[25,50,100,200,300,500];t<a.length;t++){var n=a[t];if(e/n<=20)return n}return 1e3}(i);return{filteredCount:i,pagedData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,n=(t-1)*a;return y.a.drop(e,n).slice(0,a)}(u,t,s),pagesize:s}};var Q=a(39),A=a.n(Q),H=(a(102),a(16)),I=a.n(H),U=function(e){var t=e.fromDate,a=e.toDate,o=e.onChangeFromDate,c=e.onChangeToDate,l=e.onSubmit;return r.a.createElement(n.Fragment,null,r.a.createElement("h5",null,"Please select period from/to dates then press Submit for a new selection"),r.a.createElement("form",{onSubmit:function(e){return l(e)}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"form-group col-3"},r.a.createElement("label",{htmlFor:"fromDate"},"From Date"),r.a.createElement(A.a,{placeholder:t,onDayChange:function(e){return o(I()(e).format("YYYY-MM-DD"))}})),r.a.createElement("div",{className:"form-group col-3"},r.a.createElement("label",{htmlFor:"toDate"},"To Date"),r.a.createElement(A.a,{placeholder:a,onDayChange:function(e){return c(I()(e).format("YYYY-MM-DD"))}}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-2"},r.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Submit")))),r.a.createElement("hr",null))},J=function(e){var t=e.value,a=e.onChange,n=e.label;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"query"},n),r.a.createElement("input",{type:"text",name:"query",className:"form-control my-3",placeholder:"Search..",value:t,onChange:function(e){return a(e.currentTarget.value)}}))},R=a(54),W=a(61),Z=function(e){var t=e.name,a=e.label,n=e.options,o=e.value,c=Object(R.a)(e,["name","label","options","value"]),l=n.map(function(e){var t={};return t.value=e,t.label=e,t});return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:t},a),r.a.createElement(W.a,Object.assign({},c,{value:l.filter(function(e){return e.value===o}),name:t,id:t,options:l})))},_=function(e){var t=e.selectedMagitude,a=e.onChangeMagitude,o=e.optionsMagList,c=e.selectedMagitudeType,l=e.onChangeMagitudeType,u=e.optionsMagTypeList,i=e.searchQuery,s=e.onChangeSearchQuery;return r.a.createElement(n.Fragment,null,r.a.createElement("h5",null,"Select/Search to filter table"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6"},r.a.createElement(Z,{value:t,onChange:function(e){return a(e)},label:"Select Magitude",options:o})),r.a.createElement("div",{className:"col-6"},r.a.createElement(Z,{value:c,onChange:function(e){return l(e)},label:"Select Magitude Type",options:u}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3"}),r.a.createElement("div",{className:"col-6"},r.a.createElement(J,{value:i,onChange:function(e){return s(e)},label:"Search by Location"})),r.a.createElement("div",{className:"col-3"})))},$=function(e){var t=I()().subtract(3,"d").format("YYYY-MM-DD"),a=I()().format("YYYY-MM-DD"),o=Object(n.useState)(t),c=Object(h.a)(o,2),l=c[0],u=c[1],i=Object(n.useState)(a),s=Object(h.a)(i,2),m=s[0],d=s[1],g=Object(n.useState)(l),f=Object(h.a)(g,2),b=f[0],v=f[1],E=Object(n.useState)(m),y=Object(h.a)(E,2),j=y[0],O=y[1],S=Object(n.useState)(""),M=Object(h.a)(S,2),w=M[0],N=M[1],q=Object(n.useState)(""),L=Object(h.a)(q,2),F=L[0],x=L[1],Q=Object(n.useState)(1),A=Object(h.a)(Q,2),H=A[0],J=A[1],R=Object(n.useState)({path:"place",order:"asc"}),W=Object(h.a)(R,2),Z=W[0],$=W[1],G=Object(n.useState)(""),K=Object(h.a)(G,2),V=K[0],X=K[1],ee=function(e){var t=Object(h.a)(e,2),a=t[0],r=t[1],o="starttime=".concat(a,"&endtime=").concat(r),c=Object(n.useState)([]),l=Object(h.a)(c,2),u=l[0],i=l[1],s=Object(n.useState)(0),m=Object(h.a)(s,2),d=m[0],g=m[1],f=Object(n.useState)(null),b=Object(h.a)(f,2),v=b[0],E=b[1],y=Object(n.useState)(!0),j=Object(h.a)(y,2),O=j[0],S=j[1],C=Object(n.useState)([]),k=Object(h.a)(C,2),M=k[0],w=k[1],N=Object(n.useState)([]),q=Object(h.a)(N,2),L=q[0],F=q[1];return Object(n.useEffect)(function(){function e(){return(e=Object(T.a)(D.a.mark(function e(){var t,a,n,r,c,l,u,s;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),console.log("Fetching earthquake data from server using query string: ".concat(o)),e.prev=2,e.next=5,Y(o);case 5:t=e.sent,e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(2),p.b.error(e.t0.response.data),e.abrupt("return");case 12:a=t.data,n=a.features,r=a.metadata,c=z(n),l=c.extractedEarthquakeData,u=c.magList,s=c.magTypeList,i(l),w(u),F(s),g(r.count),E("".concat(r.title," - Report generated as at ").concat(P()({date:new Date(r.generated),local:!0,showTimeZone:!0}))),S(!1);case 20:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[a,r,o]),{earthquakedata:u,count:d,loading:O,title:v,magList:M,magTypeList:L}}([l,m]),te=ee.title,ae=ee.earthquakedata,ne=ee.loading,re=ee.count,oe=ee.magList,ce=ee.magTypeList,le=function(e){var t=Object(h.a)(e,6),a=t[0],r=t[1],o=t[2],c=t[3],l=t[4],u=t[5],i=Object(n.useState)([]),s=Object(h.a)(i,2),m=s[0],d=s[1],g=Object(n.useState)(0),p=Object(h.a)(g,2),f=p[0],b=p[1],v=Object(n.useState)(0),E=Object(h.a)(v,2),y=E[0],j=E[1];return Object(n.useEffect)(function(){console.log(r,o);var e=B({earthquakedata:a,selectedMagitude:l,selectedMagitudeType:u,currentpage:r,searchQuery:c,sortcolumn:o}),t=e.filteredCount,n=e.pagedData,i=e.pagesize;console.log(i),d(n),b(t),j(i)},[a,r,o,c,l,u]),{pagedEarthquakeData:m,filteredcount:f,pagesize:y}}([ae,H,Z,V,w,F]),ue=le.pagedEarthquakeData,ie=le.filteredcount,se=le.pagesize;function me(e){console.log("handlePageChange()",e),J(e)}return r.a.createElement(n.Fragment,null,r.a.createElement("div",null,r.a.createElement("h3",null,te)),r.a.createElement(U,{fromDate:b,toDate:j,onChangeFromDate:function(e){console.log("handleStartTime()",e),v(e)},onChangeToDate:function(e){console.log("handleEndTime()",e),O(e)},onSubmit:function(e){d(j),u(b),J(1),e.preventDefault()}}),r.a.createElement(_,{selectedMagitude:w,onChangeMagitude:function(e){var t=e.value;console.log("handleSelectMagitude()",t),N(t),x(""),X(""),J(1)},optionsMagList:oe,selectedMagitudeType:F,onChangeMagitudeType:function(e){var t=e.value;console.log("handleSelectMagitudeType()",t),x(t),N(""),X(""),J(1)},optionsMagTypeList:ce,searchQuery:V,onChangeSearchQuery:function(e){console.log("handleSearch()",e),X(e),N(""),x(""),J(1)}}),r.a.createElement("div",null,ne?r.a.createElement("div",null," ",r.a.createElement("h2",null,"Loading")):ie?r.a.createElement(n.Fragment,null,r.a.createElement("p",null,"Total Events: ",re," Filtered Events: ",ie," "),r.a.createElement(k,{itemsCount:ie,pageSize:se,currentPage:H,onPageChange:me}),r.a.createElement(C,{earthquakedata:ue,sortColumn:Z,onSort:function(e){console.log("handleSort()",e),$(e)}}),r.a.createElement(k,{itemsCount:ie,pageSize:se,currentPage:H,onPageChange:me})):r.a.createElement("div",null,r.a.createElement("h2",null,"Nothing to display"))))},G=(a(110),a(111),a(18)),K=a(40);G.b.add(K.b,K.a);var V=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement(p.a,null),r.a.createElement("main",{className:"container"},r.a.createElement(g.d,null,r.a.createElement(g.b,{path:"/earthquakes",component:$}),r.a.createElement(g.a,{exact:!0,from:"/",to:"/earthquakes"}),r.a.createElement(g.a,{to:"/earthquakes"}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(118);c.a.render(r.a.createElement(l.a,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},63:function(e,t,a){e.exports=a(119)},68:function(e,t,a){}},[[63,1,2]]]);
//# sourceMappingURL=main.23bf4f89.chunk.js.map